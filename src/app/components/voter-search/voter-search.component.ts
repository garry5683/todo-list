import { Component } from '@angular/core';
import { DomSanitizer } from '@angular/platform-browser';
import { CommonService } from 'src/app/services/common.service';

@Component({
  selector: 'app-voter-search',
  templateUrl: './voter-search.component.html',
  styleUrls: ['./voter-search.component.scss']
})
export class VoterSearchComponent {

    constructor(
      private commonservice: CommonService,
      private sanitizer: DomSanitizer
  ) { }
  
  output:any=[];
  header:any=[
  "#",
  "Part Sr#",
  "District",
  "LocalBody",
  "Ward",
  "Polling Station",
  "Voter Name",
  "Oldwardno / House",
  "Gender",
  "Age",
  "Voter Id"
];
  
  ngOnInit() {
    this.list.forEach((element:any) => {

    this.commonservice.voterSearch(element).subscribe((result: any) => {
      let htmlString = (result.form);

      const parser = new DOMParser();
      const doc = parser.parseFromString(htmlString, 'text/html');

      // Extract rows
      let rows = Array.from(doc.querySelectorAll("tbody tr")).map(tr => {
        const cells = Array.from(tr.querySelectorAll("td")).map(td => td.textContent?.trim() || "");
        const obj: any = {};
        this.header.forEach((header:any, i:any) => {
          obj[header] = cells[i] || "";
        });
        return obj;
      });
      rows.forEach(elementChild => {
        elementChild['Voter Id'] = element;
      });

      if(rows.length>1 && !this.checkIfNameExists(rows[0]['Voter Id'])){
      this.output.push(rows)
      }
    })
  })
  }

  checkIfNameExists(name: any): boolean {
  return this.output.some(
    (table:any) => table.some(
      (row:any) => row["Voter Name"]?.toLowerCase() === name.toLowerCase()
    )
  );
}

  list:any=["XKE0455766",
"BNT1242338",
"BNT1242346",
"BNT1722867",
"XKE0334276",
"KL/09/057/105125",
"XKE0096156",
"BNT1558741",
"KL/09/057/105122",
"SECIDBE7DD38F",
"KL/09/057/105097",
"KL/09/057/105298",
"KL/09/057/105134",
"KL/09/057/105374",
"KL/09/057/105207",
"XKE0329268",
"KL/09/057/105399",
"KL/09/057/105380",
"BNT1111764",
"LCY1833433",
"BNT1676063",
"KL/09/057/105639",
"KL/09/057/105096",
"BNT1180892",
"BNT1553874",
"KL/09/057/105479",
"KL/09/057/105478",
"BNT1566116",
"LCY1727551",
"LCY1727569",
"BNT1714815",
"KL/09/057/105475",
"BNT1554567",
"KL/09/057/105405",
"KL/09/057/105344",
"XKE0171611",
"XKE0452003",
"XKE0100453",
"XKE0374447",
"KL/09/057/105114",
"KL/09/057/105350",
"BNT1725779",
"BNT1116391",
"KL/09/057/105537",
"KL/09/057/105421",
"BNT1514918",
"BNT1514926",
"XKE0371716",
"XKE0372227",
"XKE0371930",
"XKE0066795",
"BNT1242320",
"XKE0066811",
"GLD2149268",
"BNT1114776",
"BSY1562867",
"BNT1111889",
"KL/09/057/105247",
"KL/09/057/105546",
"SECIDD2FEAA20",
"KL/09/057/081036",
"KL/09/057/105227",
"KL/09/057/105331",
"KL/09/057/105330",
"XKE0357426",
"XKE0370841",
"BNT1517861",
"BNT1108463",
"XKE0233148",
"XKE0422584",
"XKE0436436",
"XKE0409631",
"XKE0256693",
"XKE0167320",
"KL/09/059/459335",
"KL/09/059/303261",
"KL/09/057/114603",
"XKE0037085",
"KL/09/057/105472",
"XKE0167239",
"XKE0378448",
"KL/09/057/105353",
"XKE0243634",
"SECID22011423",
"KL/09/057/105579",
"KL/09/057/105467",
"BNT1242064",
"KL/09/057/105465",
"KL/09/057/105528",
"BNT1116086",
"SECIDF45C336E",
"SECIDD3E5015E",
"BNT1520063",
"BNT1520196",
"BNT1526110",
"BNT1526128",
"XKE0260356",
"XKE0483388",
"SECID22011382",
"XKE0743997",
"KL/09/057/120056",
"XKE0260372",
"SECIDEA5F205C",
"KL/09/057/105449",
"KL/09/057/105060",
"BNT1116656",
"SECID22011426",
"KL/09/057/105432",
"KL/09/057/105547",
"BNT1756535",
"BNT1115690",
"BSY1582295",
"KL/09/057/105285",
"BNT1115625",
"MST1648823",
"SECID22011391",
"SECID22011392",
"XKE0172106",
"XKE0306225",
"KL/09/057/105005",
"KL/09/057/105109",
"KL/09/057/105269",
"KL/09/057/105062",
"BNT1756543",
"BNT1755271",
"XKE0409623",
"SECID22011387",
"KL/09/057/105052",
"BNT1116029",
"SECID2B2949E7",
"SECID22011404",
"SECID77EC0AE7",
"KL/09/057/105647",
"KL/09/057/105646",
"XKE0420471",
"SECID22011427",
"KL/09/057/105627",
"KL/09/057/105228",
"KL/09/057/105464",
"SECID746A782C",
"KL/09/057/105404",
"MZL1117860",
"KL/09/057/105462",
"SECID22011388",
"KL/09/057/105278",
"HVK1080167",
"KL/09/057/105241",
"XKE0485904",
"BNT1510205",
"BNT1524529",
"BNT1524230",
"KL/09/057/105209",
"KL/09/064/255640",
"SECID22011384",
"XKE6705859",
"SECIDE9BB973A",
"BNT1114024",
"KL/09/057/105641",
"KL/09/057/297084",
"SECID22011420",
"SECID22011411",
"KL/09/057/105037",
"XKE0102533",
"SECID22011394",
"KL/09/057/105636",
"XKE0738864",
"XKE6705917",
"SECID22011401",
"SECID22011400",
"XKE0016121",
"KL/09/057/105070",
"KL/09/057/105485",
"KL/09/057/105054",
"KL/09/057/105392",
"XKE0371427",
"SECID12DFA1C1",
"XKE0016139",
"XKE0016295",
"XKE0420497",
"XKE0419911",
"KL/09/057/105573",
"KL/09/057/105038",
"KL/09/057/105259",
"XKE0541193",
"XKE0420380",
"SECID22011386",
"SECID4BE555F2",
"KL/09/057/105153",
"KL/09/057/105625",
"KL/09/057/105260",
"XKE0409607",
"KL/09/057/105355",
"KL/09/057/105102",
"KL/09/057/105591",
"KL/09/057/105590",
"SECID22011414",
"XKE0490508",
"KL/09/057/084190",
"XKE0425322",
"KL/09/057/084418",
"KL/09/057/084667",
"BNT1572346",
"BNT1563568",
"KL/09/057/105080",
"LCY1507102",
"LCY1507094",
"XKE0253302",
"KL/09/057/105151",
"IDZ0076687",
"KL/09/064/405461",
"BNT1755743",
"XKE0016378",
"KL/09/057/105491",
"BNT1442680",
"XKE0248732",
"XKE0248716",
"KL/09/057/105538",
"KL/09/057/105652",
"KL/09/057/105393",
"XKE0541136",
"XKE0420430",
"SECID22011383",
"SECID514DEBDF",
"KL/09/057/006423",
"KL/09/057/105395",
"BNT1694546",
"XKE0422600",
"KL/09/057/105376",
"KL/09/057/105375",
"BNT1115906",
"BNT1208537",
"BNT1115146",
"KL/09/057/105500",
"BNT1282789",
"XKE0306209",
"SECID22011385",
"KL/09/057/117161",
"LJL1140136",
"SECID22011416",
"BNT1116128",
"KL/09/057/105203",
"BNT1761097",
"KL/09/057/105615",
"KL/09/057/105521",
"KL/09/057/105520",
"BNT1522044",
"SECID22011389",
"BNT1591163",
"SECID22011390",
"KL/09/057/105142",
"XKE0370411",
"KL/09/057/126617",
"KL/09/057/105544",
"KL/09/057/105313",
"KL/09/057/105634",
"KL/09/057/105474",
"XKE0368258",
"XKE0357616",
"KL/09/057/105364",
"KL/09/057/105303",
"BNT1694538",
"SECID22011399",
"XKE0041830",
"SECID22011393",
"KL/09/057/105382",
"KL/09/057/105301",
"DLV1242874",
"LJL1050434",
"XKE0354647",
"XKE0354654",
"KL/09/057/105445",
"XKE0106203",
"KL/09/057/105419",
"KL/09/060/057730",
"XKE0374439",
"XKE0416792",
"XKE0416800",
"KL/09/058/093594",
"KL/09/058/093555",
"XKE0266197",
"BNT1115443",
"BNT1115369",
"BNT1609882",
"BNT1090018",
"BNT1090026",
"BNT1727411",
"XKE0066118",
"SECID22011417",
"KL/09/057/105148",
"KL/09/057/105463",
"KL/09/059/453359",
"KL/09/059/453344",
"BNT1115153",
"BNT1524685",
"LJL1482348",
"XKE0483271",
"XKE0240218",
"XKE0366179",
"SECID22011431",
"BNT1607191",
"XKE0485870",
"XKE0485920",
"XKE0483404",
"XKE0232199",
"XKE0232223",
"BNT1357037",
"XKE0409615",
"XKE0485946",
"BNT1558071",
"KL/09/057/105443",
"BNT1558055",
"KL/09/057/105157",
"BNT1675511",
"XKE0040477",
"XKE0164137",
"KL/09/057/105365",
"XKE0247551",
"KL/09/057/105519",
"XKE0247528",
"KL/09/057/105341",
"KL/09/057/105592",
"BNT1573674",
"BNT1578343",
"LJV1621333",
"LCY1896711",
"XKE0067173",
"XKE0067140",
"XKE0329250",
"XKE0329276",
"XKE0066902",
"BNT1651017",
"BNT1755982",
"KL/09/057/105305",
"KL/09/057/201450",
"BSY1560200",
"BSY1434224",
"XKE0379388",
"KL/09/057/105483",
"BNT1115971",
"KL/09/057/105481",
"SECID22011415",
"XKE0425355",
"BWG1797901",
"XKE0305094",
"XKE0305144",
"XKE0422535",
"XKE0422360",
"XKE0395806",
"SECID2A21E12B",
"XKE0435875",
"XKE0075754",
"XKE0494799",
"SECID22011433",
"BNT1115682",
"BSY1381938",
"XKE0237974",
"KL/09/057/105282",
"XKE0238196",
"XKE0040832",
"XKE0238055",
"XKE0238121",
"SECID22011432",
"SECID22011429",
"SECID22011430",
"SECID22011436",
"SECID22011437",
"SECID22011438",
"SECIDA97D4936",
"LJL1472075",
"LJL1472075",
"XKE0377499",
"KL/09/057/114456",
"KL/09/057/114587",
"XKE0230102",
"XKE0230169",
"BNT1568559",
"KL/09/057/105161",
"XKE0420455",
"SECID9C05DFAA",
"SECIDFA2AEA63",
"BNT1114842",
"SECID37F74C01",
"SECID22011421",
"KL/09/057/105198",
"KL/09/057/105160",
"XKE0015891",
"KL/09/057/105283",
"KL/09/057/105159",
"XKE0422592",
"XKE0321208",
"SECID22011407",
"SECID22011405",
"SECID22011406",
"XKE0094813",
"KL/09/057/105031",
"LCY1724343",
"KL/09/057/105381",
"KL/09/057/105032",
"KL/09/057/105141",
"BNT1114834",
"XKE0420539",
"XKE0420513",
"KL/09/057/105045",
"KL/09/058/009277",
"BNT1742410",
"KL/09/057/105223",
"KL/09/057/105600",
"KL/09/057/105599",
"XKE0164079",
"KL/09/057/105362",
"KL/09/057/105386",
"XKE0086736",
"XKE0435818",
"XKE0086744",
"SECIDF3931E6E",
"XKE0455758",
"KL/09/057/105206",
"XKE0103416",
"KL/09/057/105387",
"KL/09/057/105385",
"XKE0103408",
"BNT1516731",
"KL/09/057/087443",
"KL/09/057/087517",
"KL/09/057/105295",
"KL/09/057/105081",
"KL/09/057/087561",
"XKE0238519",
"KL/09/057/087326",
"XKE0238493",
"KL/09/057/105111",
"KL/09/057/105415",
"XKE0104216",
"XKE0171025",
"KL/09/057/105194",
"KL/09/057/105200",
"KL/09/057/105318",
"KL/09/057/105199",
"KL/09/057/105618",
"KL/09/057/105213",
"XKE0248500",
"KL/09/057/105140",
"KL/09/057/105214",
"SECIDA5393D15",
"XKE0243097",
"SECID2D3833AF",
"KL/09/057/105065",
"KL/09/057/105317",
"KL/09/057/105124",
"KL/09/057/180162",
"BNT1565258",
"SECID8FD08BF8",
"KL/09/057/087642",
"MHQ1195932",
"SECIDC717937F",
"KL/09/057/105417",
"KL/09/057/105024",
"KL/09/057/105025",
"XKE0074997",
"BNT1791870",
"XKE0248526",
"KL/09/057/105050",
"KL/09/057/105049",
"BNT1538974",
"BNT1678580",
"KL/09/057/105506",
"KL/09/057/105505",
"KL/09/057/105507",
"KL/09/057/105195",
"KL/09/057/105532",
"BNT1115542",
"BNT1115294",
"BNT1521327",
"KL/09/057/105246",
"KL/09/057/105534",
"BNT1519966",
"BNT1353770",
"XKE0168120",
"KL/09/057/105531",
"KL/09/057/105529",
"KL/09/057/105358",
"SECID31438810",
"KL/09/057/105585",
"XKE0405126",
"SECIDEFC0E4C8",
"KL/09/058/147425",
"KL/09/057/105255",
"KL/09/057/105256",
"KL/09/057/105414",
"XKE0239707",
"LJL1022227",
"BNT1520931",
"XKE0035204",
"XKE0035212",
"KL/09/057/105412",
"KL/09/057/105411",
"KL/09/057/105413",
"XKE0534198",
"XKE0773283",
"SECID564201BF",
"KL/09/057/105452",
"KL/09/057/285128",
"KL/09/057/105261",
"KL/09/057/105320",
"KL/09/057/297189",
"KL/09/057/105453",
"BNT1573237",
"SECID22011418",
"KL/09/057/105454",
"KL/09/057/105401",
"BNT1651611",
"SECID31438809",
"LCY1474329",
"XKE0245217",
"XKE0168179",
"KL/09/057/102655",
"BNT1754019",
"XKE0102137",
"BNT1520923",
"KL/09/057/105595",
"BNT1520717",
"XKE0470443",
"XKE0245183",
"XKE0245142",
"XKE0374017",
"KL/09/057/105530",
"KL/09/057/105244",
"KL/09/057/105274",
"KL/09/057/105335",
"SECID6BB20979",
"KL/09/057/105598",
"KL/09/057/105489",
"BNT1514983",
"XKE0306027",
"KL/09/057/105402",
"XKE0306035",
"SECID151870F5",
"SECIDCD4BD521",
"KL/09/057/105108",
"IDZ0296939",
"XKE0088815",
"XKE0420232",
"KL/09/057/105083",
"KL/09/057/105343",
"KL/09/057/105409",
"SECID495D288A",
"SECID22011443",
"BNT1621473",
"KL/09/057/105119",
"KL/09/057/105018",
"BNT1419068",
"BNT1420223",
"KL/09/057/105162",
"KL/09/057/105253",
"BNT1522705",
"KL/09/058/255273",
"BNT1610583",
"BNT1718964",
"SECID22011422",
"BNT1301530",
"KL/09/057/105389",
"XKE0168245",
"SECID8E53212F",
"KL/09/057/105177",
"KL/09/057/105617",
"KL/09/057/105536",
"KL/09/057/105047",
"BNT1115856",
"BNT1109537",
"BNT1420215",
"KL/09/057/114471",
"XKE0728352",
"XKE6629356",
"XKE6679625",
"XKE0235010",
"KL/09/057/105231",
"XKE0534180",
"XKE0781765",
"KL/09/057/105379",
"KL/09/057/105377",
"KL/09/057/105450",
"KL/09/057/105273",
"KL/09/057/105272",
"BNT1559616",
"LJL1025659",
"KL/09/065/078131",
"BNT1371202",
"XKE0090662",
"XKE0068106",
"XKE0452185",
"KL/09/057/105249",
"KL/09/057/105608",
"KL/09/057/105470",
"KL/09/057/105607",
"KL/09/057/105471",
"KL/09/057/102157",
"BNT1521079",
"SECIDE83C2BB3",
"XKE6658272",
"SECID2890C135",
"XKE0485953",
"BNT1282367",
"XKE0269159",
"KL/09/057/105572",
"BNT1278506",
"KL/09/058/057258",
"KL/09/057/105571",
"KL/09/057/060276",
"XKE0099283",
"XKE0099291",
"XKE0096230",
"XKE0439414",
"BNT1114677",
"BNT1601343",
"BNT1753540",
"BNT1714641",
"BNT1753557",
"XKE0425330",
"XKE0425348",
"BNT1701184",
"BSY1751379",
"XKE0435610",
"XKE0435578",
"KL/09/057/102291",
"KL/09/057/102350",
"BNT1416916",
"BNT1411909",
"XKE0441287",
"BNT1115351",
"BNT1417484",
"KL/09/057/102557",
"BNT1714930",
"BNT1748664",
"KL/09/057/102526",
"BNT1527761",
"KL/09/057/102118",
"KL/09/057/102625",
"KL/09/057/102040",
"XKE0248369",
"KL/08/056/195604",
"KL/09/057/111032",
"SECID22011397",
"SECID22011398",
"SECID22011395",
"SECID22011396",
"SECID7A0FD5AB",
"SECID5B5CFEB5",
"XKE0236752",
"KL/09/057/102289",
"XKE0236729",
"XKE0305896",
"SECID7265D0D9",
"XKE0306159",
"KL/09/057/102177"
]
}
